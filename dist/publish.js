"use strict";module.exports=function(e,t,p){var n={bump:{type:"patch"},dest:".",git:{branch:"master",options:{args:" --tag"},remote:{name:"origin"}},name:"publish",src:["bower.json","bower-shrinkwrap.json","npm-shrinkwrap.json","package.json"],tasks:void 0};return function(i){i=p.merge({},n,i);var r=i.name+":commit",s=i.name+":push",a=i.name+":npm",o=i.name,m=i.name+":tag";return e.task(m,i.tasks,function(){var p=t.filter("package.json",{restore:!0});return e.src(i.src).pipe(t.debug({title:m})).pipe(t.plumber()).pipe(t.bump(i.bump)).pipe(e.dest(i.dest)).pipe(p).pipe(t.shrinkwrap()).pipe(p.restore).pipe(e.dest(i.dest)).pipe(p).pipe(t.tag())}),e.task(r,[m],function(){return e.src(i.src).pipe(t.debug({title:"git:"})).pipe(t.plumber()).pipe(t.git.commit(i.bump.type))}),{npm:function(){e.task(s,function(){t.git.push(i.git.remote.name,i.git.branch,i.git.options)}),e.task(o,[s],function(e){p.spawn("win32"===process.platform?"npm.cmd":"npm",["publish"],{stdio:"inherit"}).on("close",e)}),e.task(a,[r],function(){return e.start([s,o])})}}}};