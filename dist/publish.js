"use strict";module.exports=function(e){var t=require("merge"),p=require("gulp-load-plugins")(e),i=require("child_process").spawn,n={bump:{type:"patch"},dest:".",git:{branch:"master",options:{args:" --tag"},remote:{name:"origin"}},name:"publish",src:["bower.json","package.json"],tasks:void 0};return function(r){r=t({},n,r);var s=r.name+":push",a=r.name+":npm",o=(r.name+":prep",r.name+":publish"),u=r.name+":tag";return e.task(u,r.tasks,function(){var t=p.filter("package.json",{restore:!0});return e.src(r.src).pipe(p.debug({title:u})).pipe(p.bump(r.bump)).pipe(e.dest(r.dest)).pipe(t).pipe(p.shrinkwrap()).pipe(t.restore).pipe(e.dest(r.dest)).pipe(p.git.commit(r.bump.type)).pipe(t).pipe(p.tagVersion())}),e.task(s,function(){p.git.push(r.git.remote.name,r.git.branch,r.git.options)}),e.task(o,function(e){i("win32"===process.platform?"npm.cmd":"npm",["publish"],{stdio:"inherit"}).on("close",e)}),{npm:function(){e.task(a,[u],function(){return e.start([s,o])})}}}};